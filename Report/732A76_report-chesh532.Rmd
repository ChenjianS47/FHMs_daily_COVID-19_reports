---
title: "732A76_report-chesh532"
author: "Chenjian Shi"
date: "2021/12/30"
output: 
  pdf_document: 
    latex_engine: lualatex
    toc: yes
    number_sections: yes
bibliography: Reference.bib
abstract: .
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Introduction




# Background


# Data Access

The data is downloaded  Folkhalsomyndigheten’s daily excel spread sheet report concerning COVID19 in Sweden from Wayback machine. In order to access the data, here we used a python script[.python_script] which implemented by a package called selenium[@selenium]. The selenium we used in this project is the Selenium WebDriver. This is a kind of browser-based automation test suites, which allows python scripts run the automation tests like mouse clicking,etc. by locating the xpath elements of the website,etc..

In this paper, we would use the chrome driver(version 96.0.4664.45, based on Chrome 96.0.4664.110) which download from Chrome Driver's official website[@ChromeDriver], which is the webdriver for the Chrome. 

The total script contains the files below:


## Configs

Before running the main script, we first need to do some settings in the config.py file.

```{bash eval=FALSE, include=TRUE}
# Config.py

# Location of chrome driver
chrome_driver = r"C:\Program Files (x86)\Google\Chrome\Application\chromedriver.exe"

# Url for Wayback Machine
Wayback_Machine_URL = 'https://web.archive.org/'

# Target URL
Target_URL = ('https://www.folkhalsomyndigheten.se/smittskydd-beredskap/utbrott/aktuella-utbrott/covid-19/'
              'bekraftade-fall-i-sverige',
              'https://www.folkhalsomyndigheten.se/smittskydd-beredskap/utbrott/aktuella-utbrott/covid-19/' \
             'statistik-och-analyser/bekraftade-fall-i-sverige/')

# Define the start date and final date
start_date = 'APR 04 2020'
final_date = 'DEC 28 2021'

# Download directory
Download_directory = r'G:\LiU\732A76_Research_Project\data'

```

In this file, we need to set the location of chrome driver first, which helps python scripts to run the webdriver. Besides, we sets the url for the Wayback Machine and the url for the Folkhalsomyndigheten in order to the get the files from the past. Then, we sets the start and end dates of the files we need, which in form of 'MON DAY YEAR'. At last, we set the download directory for the files.

## Data downloads

After finishing the setting of configs.py, we just run the 'main.py' file so that the download would start. The process of the downloads(in PyCharm IDE) would be like this 

```{bash eval=FALSE, include=TRUE}
Jan 02 2022 - 23:25:14, Start to downloading files
Jan 02 2022 - 23:26:18, Finished downloading of the file in Sep 17 2021
Jan 02 2022 - 23:27:20, Finished downloading of the file in Sep 18 2021
```


If there is no data at that date or failed the downloads, the script would shows like this

```{bash eval=FALSE, include=TRUE}
Jan 02 2022 - 23:25:14, Start to downloading files
Jan 02 2022 - 23:26:18, failed to download the file in Sep 17 2021
Jan 02 2022 - 23:27:20, No file could be download in Sep 18 2021
```

Each downloads may takes about 1 minitues, which depends on the network situation. The total time used in downloading the files from APR 03 2020 to DEC 28 2021 taks about 10 hours to download.

![Data files(parts)](./1-Data_file(parts).PNG)


# Data Proccessing

After we gets the data files like above, we start to do the process these data by R script[.script_for_processing].

The required packages for the script are below:
```{r eval=FALSE, include=TRUE}
library(readxl)
library(tidyverse)
library(plotly)
library(config)
library(htmlwidgets)
```


## Config
before start the process we need to do the config like we did before, but this time for the R script.

```{bash eval=FALSE, include=TRUE}
default:
  start_time: "2020/04/03"
  end_time: "2021/12/28"
  file_add_and_name: './data/Folkhalsomyndigheten_Covid19_'
  # Sheet type
  Antal per dag region: 1
  Antal avlidna per dag: 1
  Antal intensivvårdade per dag: 1
  Totalt antal per region: 2
  Totalt antal per kön: 2
  Totalt antal per åldersgrupp: 2
  # Combined sheet
  Antal per dag region_on_kön: [4,5]
  Antal per dag Åldersgrupp_on_kön: [6,5]
  Antal per dag region_on_Åldersgrupp: [4,6]
```

## Functions in the script


### Data file reading




### Visualing


### Main script





### Output



# Result Anlysis


*fig_Antal_avlidna_per_dag.html*


*fig_Antal_intensivvårdade_per_dag.html*

*fig_Antal_per_dag_Åldersgrupp_on_kön.html*


*fig_Antal_per_dag_region.html*



*fig_Antal_per_dag_region_on_Åldersgrupp.html*


*fig_Antal_per_dag_region_on_kön.html*


*fig_Totalt_antal_per_åldersgrupp.html*


*fig_Totalt_antal_per_kön.html*


*fig_Totalt_antal_per_region.html*

# Conclusion

# Appendix

Code:


Code:

# References


